(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6505:(e,t,a)=>{Promise.resolve().then(a.bind(a,7468))},7468:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var l=a(5155),r=a(2115),i=a(6766);let n=()=>(0,l.jsxs)("div",{className:"top-bar",children:[(0,l.jsx)("a",{href:"https://Calculator5329.github.io",target:"_blank",rel:"noopener noreferrer",className:"avatar-link",children:(0,l.jsx)("div",{className:"profile-avatar",children:(0,l.jsx)(i.default,{src:"/profile.png",alt:"Me",fill:!0})})}),(0,l.jsx)("h1",{className:"top-title",children:"Portfolio Backtest"})]}),o=e=>{let{startDate:t,endDate:a,initial:r,addition:i,frequency:n,weightError:o,loadingPortfolio:s,loadingTickers:d,setStartDate:c,setEndDate:u,setInitial:h,setAddition:m,setFrequency:p,onSubmit:g}=e;return(0,l.jsxs)("div",{className:"portfolio-form",children:[(0,l.jsx)("h2",{className:"sub-title",children:"Portfolio Options"}),(0,l.jsxs)("div",{className:"input-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Start Date"}),(0,l.jsx)("input",{type:"date",min:"1970-01-01",max:"2024-12-31",value:t,onChange:e=>c(e.target.value)})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"End Date"}),(0,l.jsx)("input",{type:"date",min:"1970-01-01",max:"2024-12-31",value:a,onChange:e=>u(e.target.value)})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Initial Investment ($)"}),(0,l.jsx)("input",{type:"number",min:0,max:1e7,value:r,onChange:e=>{let t=e.target.value;if(""===t)h("");else{let e=parseFloat(t);isNaN(e)?h(""):h((e=Math.max(0,Math.min(1e7,e))).toString())}},placeholder:"(e.g. 1000)"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Recurring Amount ($)"}),(0,l.jsx)("input",{type:"number",min:0,max:1e7,value:i,onChange:e=>{let t=e.target.value;if(""===t)m("");else{let e=parseFloat(t);isNaN(e)?m(""):m((e=Math.max(0,Math.min(1e7,e))).toString())}},placeholder:"(e.g. 100)"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Frequency"}),(0,l.jsxs)("select",{value:n,onChange:e=>p(e.target.value),children:[(0,l.jsx)("option",{value:"weekly",children:"Weekly"}),(0,l.jsx)("option",{value:"monthly",children:"Monthly"}),(0,l.jsx)("option",{value:"yearly",children:"Yearly"})]})]})]}),(0,l.jsx)("button",{onClick:g,className:"submit-btn",disabled:s||d,children:s?"Loading Portfolio...":d?"Loading Tickers...":"Submit"}),o&&(0,l.jsx)("p",{style:{color:"red",marginTop:"1rem",fontSize:"0.875rem"},children:o})]})},s=e=>{let{portfolio:t,defaultTickers:a,tickerContainerRef:r,updateTicker:i,addTicker:n,removeTicker:o,weightError:s}=e;return(0,l.jsxs)("div",{className:"ticker-selection",ref:r,children:[(0,l.jsx)("h2",{className:"sub-title",children:"Portfolio"}),t.map((e,r)=>(0,l.jsxs)("div",{className:"form-group",style:{display:"flex",gap:"1.5rem",marginBottom:"0.5rem",borderRadius:"10px",padding:"1rem"},children:[(0,l.jsx)("input",{list:"ticker-options",value:e.ticker,onChange:e=>i(r,"ticker",e.target.value.toUpperCase()),className:"input-field",placeholder:"Search ticker..."}),(0,l.jsx)("datalist",{id:"ticker-options",children:a.map(e=>(0,l.jsx)("option",{value:e},e))}),(0,l.jsxs)("div",{style:{position:"relative",margin:0,padding:0},children:[(0,l.jsx)("input",{type:"number",min:0,max:100,value:e.weight,onChange:e=>{let t=parseFloat(e.target.value);i(r,"weight",isNaN(t)?0:Math.max(0,Math.min(100,t)))},className:"input-field",style:{paddingRight:"2rem",margin:0},placeholder:"%"}),(0,l.jsx)("span",{style:{position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#999"},children:"%"})]}),t.length>1&&(0,l.jsx)("button",{onClick:()=>o(r),style:{background:"none",border:"none",cursor:"pointer",padding:0,margin:0,fontSize:"1.5rem",pointerEvents:"auto"},"aria-label":"Remove ticker",children:"\uD83D\uDDD1️"})]},r)),s&&(0,l.jsx)("p",{style:{color:"red",margin:0,fontSize:"0.875rem"},children:s}),(0,l.jsx)("button",{onClick:n,className:"submit-btn",children:"Add Ticker"})]})};var d=a(4065),c=a(2502);c.t1.register(c.PP,c.kc,c.FN,c.No,c.hE,c.m_,c.s$);let u=r.memo(e=>{let{chartData:t,syncedScales:a}=e;if(!t)return null;let r={responsive:!0,plugins:{legend:{position:"top"},title:{display:!1}},scales:{y1:{type:"linear",position:"left",min:null==a?void 0:a.y1Min,max:null==a?void 0:a.y1Max,ticks:{callback:e=>"$"+e},grid:{color:"rgba(255, 255, 255, 0.1)"}},y2:{type:"linear",position:"right",min:null==a?void 0:a.y2Min,max:null==a?void 0:a.y2Max,ticks:{callback:e=>Number(e)-100+"%"},grid:{drawOnChartArea:!1}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"}}}};return(0,l.jsx)(d.N1,{data:t,options:r})});u.displayName="PortfolioChart";let h=e=>{let{labels:t,portfolio:a,raw:r,syncedScales:i,loading:n}=e;return!n&&t.length&&a.length&&r.length?(0,l.jsx)("div",{className:"mt-6 chart-wrapper",style:{padding:"1rem",backgroundColor:"#050505",borderRadius:"10px",border:"1px solid #333",height:"640px",width:"calc(70% - 1rem)",marginRight:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(u,{chartData:{labels:t,datasets:[{label:"Portfolio Value",data:a,borderColor:"rgb(76, 148, 76)",pointRadius:0,tension:.1,fill:!1,yAxisID:"y1"},{label:"Growth of Initial Investment",data:r,borderColor:"rgb(116, 116, 116)",pointRadius:0,tension:.1,fill:!1,yAxisID:"y2"}]},syncedScales:i})}):null},m=r.memo(e=>{let{chartData:t}=e;return t?(0,l.jsx)(d.N1,{data:t,options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"top"},title:{display:!1}},scales:{y:{ticks:{callback:e=>Number(e)-100+"%"},grid:{color:"rgba(255, 255, 255, 0.1)"}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"}}}}}):null});m.displayName="TickerChart";let p=e=>{let{chartData:t,loading:a}=e;return a||!t?null:(0,l.jsx)("div",{className:"mt-6 chart-wrapper",style:{padding:"1rem",backgroundColor:"#050505",borderRadius:"10px",border:"1px solid #333",height:"500px",width:"60%",display:"flex",alignItems:"left",justifyContent:"left",maxWidth:"1000px"},children:(0,l.jsx)(m,{chartData:t})})},g=e=>{let{metrics:t,loading:a}=e;return(0,l.jsxs)("div",{className:"portfolio-detail",style:{width:"calc(30% - 1rem)",backgroundColor:"#101010",borderRadius:"10px",border:"1px solid #333",overflow:"hidden",height:"640px",display:"flex",flexDirection:"column"},children:[(0,l.jsx)("h2",{style:{margin:0,padding:"1rem 1.5rem",fontSize:"1.1rem",borderBottom:"1px solid #333",backgroundColor:"#181818",color:"#eee",flexShrink:0},children:"Performance Metrics"}),(0,l.jsx)("ul",{style:{listStyle:"none",margin:0,padding:0,fontSize:"0.9rem",overflowY:"auto",flexGrow:1},children:[{label:"Initial Value",format:"dollar"},{label:"Ending Value",format:"dollar"},{label:"Total Return",format:"percent"},{label:"CAGR",format:"percent"},{label:"Annualized Std Dev",format:"percent"},{label:"Best Year Return",format:"percent"},{label:"Worst Year Return",format:"percent"},{label:"Maximum Drawdown",format:"percent"},{label:"Sharpe Ratio",format:"number",digits:2},{label:"Sortino Ratio",format:"number",digits:2},{label:"Total Contributions",format:"dollar"},{label:"MWRR",format:"percent"}].map((e,r)=>{let i,{label:n,format:o,digits:s=2}=e,d=null==t?void 0:t[r];return i=null==d||a?"—":"dollar"===o?"$".concat(d.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})):"percent"===o?isNaN(d)?"—":"".concat((100*d).toFixed(s),"%"):isNaN(d)?"—":d.toFixed(s),(0,l.jsxs)("li",{style:{display:"flex",justifyContent:"space-between",padding:"0.6rem 1.5rem",backgroundColor:r%2==0?"#181818":"#151515",borderBottom:"1px solid #282828"},children:[(0,l.jsx)("span",{style:{color:"#aaa"},children:n}),(0,l.jsx)("span",{style:{color:"#eee",fontWeight:500},children:i})]},n)})})]})},x=e=>{let{tickerStats:t,tickerStatLabels:a}=e;return(0,l.jsxs)("div",{className:"ticker-metrics-container",children:[(0,l.jsx)("h2",{className:"ticker-metrics-title",children:"Individual Stock Metrics"}),(0,l.jsxs)("table",{className:"ticker-metrics-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Ticker"}),null==a?void 0:a.map(e=>(0,l.jsx)("th",{children:e},e))]})}),(0,l.jsx)("tbody",{children:t&&Object.entries(t).map(e=>{let[t,r]=e;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"ticker-label",children:t}),r.map((e,t)=>{let r;let i=(null==a?void 0:a[t])||"",n=i.includes("Value")?"dollar":i.includes("Ratio")?"number":"percent";return r=null==e||isNaN(e)?"—":"dollar"===n?"$".concat(e.toFixed(2)):"percent"===n?"".concat((100*e).toFixed(2),"%"):e.toFixed(2),(0,l.jsx)("td",{children:r},t)})]},t)})})]})]})},f=["MSFT","META","AAPL","AMZN","GOOGL","TSLA","NFLX"],b=["CAGR","Annualized Std Dev","Best Year Return","Worst Year Return","Maximum Drawdown","Sharpe Ratio","Sortino Ratio"];function j(){var e,t,a,i;let[d,c]=(0,r.useState)([{ticker:"META",weight:33},{ticker:"AMZN",weight:33},{ticker:"GOOGL",weight:34}]),[u,m]=(0,r.useState)("2020-01-01"),[j,v]=(0,r.useState)("2024-12-31"),[y,k]=(0,r.useState)("1000"),[N,S]=(0,r.useState)("10"),[w,M]=(0,r.useState)("monthly"),[C,R]=(0,r.useState)(""),[T,D]=(0,r.useState)(null),[A,E]=(0,r.useState)(null),[P,F]=(0,r.useState)(null),[O,_]=(0,r.useState)(!1),[I,L]=(0,r.useState)(!1),[z,G]=(0,r.useState)(null),B=(0,r.useRef)(null),Y=(0,r.useRef)(d.length);(0,r.useEffect)(()=>{B.current&&d.length!==Y.current&&(B.current.scrollTop=B.current.scrollHeight,Y.current=d.length)},[d.length]),(0,r.useEffect)(()=>{W()},[]),(0,r.useEffect)(()=>{(null==T?void 0:T.dates)&&T.dates.length>0&&$(T.dates)},[T,u,j]);let W=async()=>{if(_(!0),L(!1),R(""),100!==Math.round(d.reduce((e,t)=>e+(Number(t.weight)||0),0))){R("Ticker weights must add up to 100%"),_(!1);return}let e={};if(d.forEach(t=>{let{ticker:a,weight:l}=t;a&&Number(l)>=0&&(e[a]=Number(l)/100)}),0===Object.keys(e).length){R("Portfolio is empty or invalid."),_(!1);return}try{let t=await fetch("https://portfoliobackend5329.azurewebsites.net/portfolio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({portfolio:e,start_date:u,end_date:j,initial:Number(y)||0,addition:Number(N)||0,frequency:w})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();if(console.log("Portfolio Response JSON:",a),!a||!a.dates||!a.portfolio||!a.data)throw Error("Received invalid portfolio data.");D(a),E(null),G(q(a.portfolio,a.raw))}catch(e){console.error("Failed to fetch portfolio data:",e),R("Failed to load portfolio data: ".concat(e instanceof Error?e.message:String(e)))}finally{_(!1)}},$=async e=>{L(!0),E(null);let t=d.map(e=>e.ticker).filter(Boolean);try{let a=await fetch("https://portfoliobackend5329.azurewebsites.net/ticker_chart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tickers:t,start_date:u,end_date:j})}),l=await a.json();E(V(l.tickerVals,e)),F(l.tickerStats)}catch(e){console.error("Ticker chart fetch error:",e)}finally{L(!1)}},V=(e,t)=>{let a=["#4e79a7","#f28e2b","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"];return{labels:t,datasets:Object.keys(e).map((t,l)=>({label:t,data:e[t],borderColor:a[l%a.length],fill:!1,tension:.2,pointRadius:0}))}},q=(e,t)=>{if(!e.length||!t.length||0===e[0]||0===t[0])return null;let a=Math.min(...e)/e[0],l=Math.max(...e)/e[0],r=Math.min(...t)/t[0],i=Math.max(...t)/t[0],n=Math.min(a,r)*e[0],o=Math.max(l,i)*e[0],s=Math.pow(10,Math.ceil(Math.log10(Math.max(...e))-1)),d=Math.floor(n/s)*s,c=Math.ceil(o/s)*s,u=Math.round(d/e[0]*t[0]),h=Math.round(c/e[0]*t[0]);return{y1Min:d,y1Max:c,y2Min:u,y2Max:h}};return(0,l.jsxs)("main",{children:[(0,l.jsx)(n,{}),(0,l.jsxs)("div",{className:"portfolio-container",children:[(0,l.jsx)(o,{startDate:u,endDate:j,initial:y,addition:N,frequency:w,weightError:C,loadingPortfolio:O,loadingTickers:I,setStartDate:m,setEndDate:v,setInitial:k,setAddition:S,setFrequency:M,onSubmit:()=>{W()}}),(0,l.jsx)(s,{portfolio:d,defaultTickers:f,tickerContainerRef:B,updateTicker:(e,t,a)=>{let l=[...d];l[e]={...l[e],[t]:a},c(l)},addTicker:()=>{c([...d,{ticker:"AAPL",weight:0}])},removeTicker:e=>{if(d.length>1){let t=[...d];t.splice(e,1),c(t)}},weightError:C})]}),(0,l.jsxs)("div",{className:"output_container",children:[(0,l.jsx)(h,{labels:null!==(e=null==T?void 0:T.dates)&&void 0!==e?e:[],portfolio:null!==(t=null==T?void 0:T.portfolio)&&void 0!==t?t:[],raw:null!==(a=null==T?void 0:T.raw)&&void 0!==a?a:[],syncedScales:z,loading:O}),(0,l.jsx)(g,{metrics:null!==(i=null==T?void 0:T.data)&&void 0!==i?i:null,loading:O})]}),(0,l.jsxs)("div",{className:"output_container ticker-chart-container",style:{marginTop:"2rem"},children:[(0,l.jsx)(p,{chartData:A,loading:I}),(0,l.jsx)(x,{tickerStats:P,tickerStatLabels:b})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,396,441,684,358],()=>t(6505)),_N_E=e.O()}]);